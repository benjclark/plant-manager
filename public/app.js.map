{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/app.js","src/http-requests.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","const httpRequests = require('./http-requests');\n\n$('[data-plant-date-planted]').datepicker({format: 'yyyy/mm/dd'});\n\nfunction closeAllOverlays() {\n    const overlays = document.querySelectorAll('.overlay');\n    overlays.forEach(el => {el.classList.add('hidden')});\n}\n\nfunction retrieveBedFromWindowObject(name) {\n    const rectangles = window.plantManager.rectangles;\n    for (let i = 0; i < rectangles.length; i++) {\n        if (rectangles[i].name === name) {\n            return rectangles[i];\n        }\n    }\n\n}\n\nfunction createBedRectInWindow() {\n    const createBedForm = document.querySelector('form[data-create-bed]');\n    window.plantManager.rectangles.push({\n        name: createBedForm.querySelector('input[data-bed-name]').value,\n        x: 200,\n        y: 300,\n        width: createBedForm.querySelector('input[data-bed-width]').value,\n        height: createBedForm.querySelector('input[data-bed-height]').value,\n        fill: createBedForm.querySelector('input[data-bed-colour]').value,\n        soil_characteristics: createBedForm.querySelector('select[data-bed-soil-characteristics]').value,\n        bed_type: createBedForm.querySelector('select[data-bed-type]').value,\n        isDragging: false\n    });\n}\n\nfunction updateBedRectInWindow() {\n    const updateBedForm = document.querySelector('form[data-update-bed]');\n    const name = updateBedForm.querySelector('[data-bed-name]').value;\n    const bed = retrieveBedFromWindowObject(name);\n    bed.name = name;\n    bed.width = parseInt(updateBedForm.querySelector('[data-bed-width]').value, 10);\n    bed.height = parseInt(updateBedForm.querySelector('[data-bed-height]').value, 10);\n    bed.fill = updateBedForm.querySelector('[data-bed-colour]').value;\n    bed.soilCharacteristics = updateBedForm.querySelector('[data-bed-soil-characteristics]').value;\n    bed.type = updateBedForm.querySelector('[data-bed-type]').value;\n}\n\ndocument.querySelector('form[data-create-plant]').addEventListener('submit', event => {\n    event.preventDefault();\n    httpRequests.sendCreatePlantRequest();\n    closeAllOverlays();\n});\n\ndocument.querySelector('form[data-create-bed]').addEventListener('submit', event => {\n    event.preventDefault();\n    httpRequests.sendCreateBedRequest();\n    createBedRectInWindow();\n    window.plantManager.drawAll();\n    closeAllOverlays();\n});\n\ndocument.querySelector('button[data-update-beds]').addEventListener('click', event => {\n    event.preventDefault();\n    httpRequests.sendSaveAllBedPositionsRequest();\n});\n\ndocument.querySelector('input[data-save-bed]').addEventListener('click', event => {\n    event.preventDefault();\n    updateBedRectInWindow();\n    httpRequests.sendSaveBedRequest();\n    window.plantManager.drawAll();\n});\n\ndocument.querySelector('input[data-delete-bed]').addEventListener('click', event => {\n    event.preventDefault();\n    httpRequests.sendDeleteBedRequest();\n    window.plantManager.drawAll();\n});\n\n[].slice.call(document.querySelectorAll('[data-add-button]')).forEach(button => {\n    const value = button.dataset.addButton;\n    button.addEventListener('click', event => {\n        document.querySelector(`div[data-add-${value}-overlay]`).classList.remove('hidden');\n    });\n});\n\n[].slice.call(document.querySelectorAll('[data-close-button]')).forEach(button => {\n    const value = button.dataset.closeButton;\n    button.addEventListener('click', event => {\n        document.querySelector(`div[data-add-${value}-overlay]`).classList.add('hidden');\n    });\n});\n\nhttpRequests.get('/getBeds').then(response => {\n    response.json().then(data => {\n        let i = 1;\n        data.forEach(obj => {\n            window.plantManager.rectangles.push({\n                name: obj.bed_name,\n                x: obj.bed_x,\n                y: obj.bed_y,\n                width: obj.bed_width,\n                height: obj.bed_height,\n                fill: obj.bed_colour,\n                soil_characteristics: obj.bed_soil_characteristics,\n                bed_type: obj.bed_type,\n                isDragging: false\n            });\n            if(i <= 31) {\n                document.querySelector(`[data-table-name-${i}]`).textContent = obj.bed_name;\n                document.querySelector(`[data-table-type-${i}]`).textContent = obj.bed_type;\n                document.querySelector(`[data-table-soil-characteristics-${i}]`).textContent = obj.bed_soil_characteristics;\n                i++;\n            }\n        });\n        window.plantManager.drawAll();\n    });\n});","function sendCreatePlantRequest() {\n    const createPlantForm = document.querySelector('form[data-create-plant]');\n    const plant_name = createPlantForm.querySelector('input[data-plant-name]').value;\n    const date_planted = createPlantForm.querySelector('input[data-plant-date-planted]').value;\n    post('/createPlant', {plant_name, date_planted});\n}\n\nfunction sendCreateBedRequest() {\n    const createBedForm = document.querySelector('form[data-create-bed]');\n    const bed_name = createBedForm.querySelector('input[data-bed-name]').value;\n    const bed_soil_characteristics = createBedForm.querySelector('select[data-bed-soil-characteristics]').value;\n    const bed_type = createBedForm.querySelector('select[data-bed-type]').value;\n    const bed_width = createBedForm.querySelector('input[data-bed-width]').value;\n    const bed_height = createBedForm.querySelector('input[data-bed-height]').value;\n    const bed_colour = createBedForm.querySelector('input[data-bed-colour]').value;\n    const bed_x = 200;\n    const bed_y = 300;\n    post('/createBed', {bed_name, bed_soil_characteristics, bed_type, bed_width, bed_height, bed_colour, bed_x, bed_y});\n}\n\nfunction sendSaveAllBedPositionsRequest() {\n    const pm = window.plantManager;\n    for (let z = 0; z < pm.rectangles.length; z++) {\n        post('/updateBedPosition',{bed_name: pm.rectangles[z].name, bed_x: pm.rectangles[z].x, bed_y: pm.rectangles[z].y});\n    }\n}\n\nfunction sendSaveBedRequest() {\n    const updateBedForm = document.querySelector('form[data-update-bed]');\n    const name = updateBedForm.querySelector('[data-bed-name]').value;\n    const width = updateBedForm.querySelector('[data-bed-width]').value;\n    const height = updateBedForm.querySelector('[data-bed-height]').value;\n    const fill = updateBedForm.querySelector('[data-bed-colour]').value;\n    const soilCharacteristics = updateBedForm.querySelector('[data-bed-soil-characteristics]').value;\n    const type = updateBedForm.querySelector('[data-bed-type]').value;\n    post('/updateBed',{bed_name: name, bed_soil_characteristics: soilCharacteristics, bed_type: type, bed_width: width, bed_height: height, bed_colour: fill});\n}\n\nfunction sendDeleteBedRequest() {\n    const updateBedForm = document.querySelector('form[data-update-bed]');\n    const name = updateBedForm.querySelector('[data-bed-name]').value;\n    window.plantManager.rectangles = window.plantManager.rectangles.filter(obj => {\n        return obj.name !== name;\n    });\n    post('/deleteBed',{bed_name: name});\n}\n\nfunction post(path, data) {\n    return window.fetch(path, {\n        method: 'POST',\n        headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n    });\n}\n\nfunction get(path) {\n    return window.fetch(path, {\n        method: 'GET',\n        headers: {\n            'Accept': 'application/json',\n            'Cache-Control': 'no-cache, no-store, must-revalidate',\n            'Pragma': 'no-cache',\n            'Expires': 0\n        }\n    });\n}\n\nmodule.exports = {\n    sendCreatePlantRequest,\n    sendCreateBedRequest,\n    sendSaveAllBedPositionsRequest,\n    sendSaveBedRequest,\n    sendDeleteBedRequest,\n    get,\n    post\n};"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYXBwLmpzIiwic3JjL2h0dHAtcmVxdWVzdHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiY29uc3QgaHR0cFJlcXVlc3RzID0gcmVxdWlyZSgnLi9odHRwLXJlcXVlc3RzJyk7XG5cbiQoJ1tkYXRhLXBsYW50LWRhdGUtcGxhbnRlZF0nKS5kYXRlcGlja2VyKHtmb3JtYXQ6ICd5eXl5L21tL2RkJ30pO1xuXG5mdW5jdGlvbiBjbG9zZUFsbE92ZXJsYXlzKCkge1xuICAgIGNvbnN0IG92ZXJsYXlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm92ZXJsYXknKTtcbiAgICBvdmVybGF5cy5mb3JFYWNoKGVsID0+IHtlbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKX0pO1xufVxuXG5mdW5jdGlvbiByZXRyaWV2ZUJlZEZyb21XaW5kb3dPYmplY3QobmFtZSkge1xuICAgIGNvbnN0IHJlY3RhbmdsZXMgPSB3aW5kb3cucGxhbnRNYW5hZ2VyLnJlY3RhbmdsZXM7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWN0YW5nbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChyZWN0YW5nbGVzW2ldLm5hbWUgPT09IG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiByZWN0YW5nbGVzW2ldO1xuICAgICAgICB9XG4gICAgfVxuXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUJlZFJlY3RJbldpbmRvdygpIHtcbiAgICBjb25zdCBjcmVhdGVCZWRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVtkYXRhLWNyZWF0ZS1iZWRdJyk7XG4gICAgd2luZG93LnBsYW50TWFuYWdlci5yZWN0YW5nbGVzLnB1c2goe1xuICAgICAgICBuYW1lOiBjcmVhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W2RhdGEtYmVkLW5hbWVdJykudmFsdWUsXG4gICAgICAgIHg6IDIwMCxcbiAgICAgICAgeTogMzAwLFxuICAgICAgICB3aWR0aDogY3JlYXRlQmVkRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtkYXRhLWJlZC13aWR0aF0nKS52YWx1ZSxcbiAgICAgICAgaGVpZ2h0OiBjcmVhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W2RhdGEtYmVkLWhlaWdodF0nKS52YWx1ZSxcbiAgICAgICAgZmlsbDogY3JlYXRlQmVkRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtkYXRhLWJlZC1jb2xvdXJdJykudmFsdWUsXG4gICAgICAgIHNvaWxfY2hhcmFjdGVyaXN0aWNzOiBjcmVhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdFtkYXRhLWJlZC1zb2lsLWNoYXJhY3RlcmlzdGljc10nKS52YWx1ZSxcbiAgICAgICAgYmVkX3R5cGU6IGNyZWF0ZUJlZEZvcm0ucXVlcnlTZWxlY3Rvcignc2VsZWN0W2RhdGEtYmVkLXR5cGVdJykudmFsdWUsXG4gICAgICAgIGlzRHJhZ2dpbmc6IGZhbHNlXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUJlZFJlY3RJbldpbmRvdygpIHtcbiAgICBjb25zdCB1cGRhdGVCZWRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVtkYXRhLXVwZGF0ZS1iZWRdJyk7XG4gICAgY29uc3QgbmFtZSA9IHVwZGF0ZUJlZEZvcm0ucXVlcnlTZWxlY3RvcignW2RhdGEtYmVkLW5hbWVdJykudmFsdWU7XG4gICAgY29uc3QgYmVkID0gcmV0cmlldmVCZWRGcm9tV2luZG93T2JqZWN0KG5hbWUpO1xuICAgIGJlZC5uYW1lID0gbmFtZTtcbiAgICBiZWQud2lkdGggPSBwYXJzZUludCh1cGRhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJlZC13aWR0aF0nKS52YWx1ZSwgMTApO1xuICAgIGJlZC5oZWlnaHQgPSBwYXJzZUludCh1cGRhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJlZC1oZWlnaHRdJykudmFsdWUsIDEwKTtcbiAgICBiZWQuZmlsbCA9IHVwZGF0ZUJlZEZvcm0ucXVlcnlTZWxlY3RvcignW2RhdGEtYmVkLWNvbG91cl0nKS52YWx1ZTtcbiAgICBiZWQuc29pbENoYXJhY3RlcmlzdGljcyA9IHVwZGF0ZUJlZEZvcm0ucXVlcnlTZWxlY3RvcignW2RhdGEtYmVkLXNvaWwtY2hhcmFjdGVyaXN0aWNzXScpLnZhbHVlO1xuICAgIGJlZC50eXBlID0gdXBkYXRlQmVkRm9ybS5xdWVyeVNlbGVjdG9yKCdbZGF0YS1iZWQtdHlwZV0nKS52YWx1ZTtcbn1cblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVtkYXRhLWNyZWF0ZS1wbGFudF0nKS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBldmVudCA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBodHRwUmVxdWVzdHMuc2VuZENyZWF0ZVBsYW50UmVxdWVzdCgpO1xuICAgIGNsb3NlQWxsT3ZlcmxheXMoKTtcbn0pO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtW2RhdGEtY3JlYXRlLWJlZF0nKS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBldmVudCA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBodHRwUmVxdWVzdHMuc2VuZENyZWF0ZUJlZFJlcXVlc3QoKTtcbiAgICBjcmVhdGVCZWRSZWN0SW5XaW5kb3coKTtcbiAgICB3aW5kb3cucGxhbnRNYW5hZ2VyLmRyYXdBbGwoKTtcbiAgICBjbG9zZUFsbE92ZXJsYXlzKCk7XG59KTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uW2RhdGEtdXBkYXRlLWJlZHNdJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudCA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBodHRwUmVxdWVzdHMuc2VuZFNhdmVBbGxCZWRQb3NpdGlvbnNSZXF1ZXN0KCk7XG59KTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbZGF0YS1zYXZlLWJlZF0nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50ID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHVwZGF0ZUJlZFJlY3RJbldpbmRvdygpO1xuICAgIGh0dHBSZXF1ZXN0cy5zZW5kU2F2ZUJlZFJlcXVlc3QoKTtcbiAgICB3aW5kb3cucGxhbnRNYW5hZ2VyLmRyYXdBbGwoKTtcbn0pO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtkYXRhLWRlbGV0ZS1iZWRdJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudCA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBodHRwUmVxdWVzdHMuc2VuZERlbGV0ZUJlZFJlcXVlc3QoKTtcbiAgICB3aW5kb3cucGxhbnRNYW5hZ2VyLmRyYXdBbGwoKTtcbn0pO1xuXG5bXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWFkZC1idXR0b25dJykpLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICBjb25zdCB2YWx1ZSA9IGJ1dHRvbi5kYXRhc2V0LmFkZEJ1dHRvbjtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudCA9PiB7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGRpdltkYXRhLWFkZC0ke3ZhbHVlfS1vdmVybGF5XWApLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIH0pO1xufSk7XG5cbltdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtY2xvc2UtYnV0dG9uXScpKS5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSBidXR0b24uZGF0YXNldC5jbG9zZUJ1dHRvbjtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudCA9PiB7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGRpdltkYXRhLWFkZC0ke3ZhbHVlfS1vdmVybGF5XWApLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIH0pO1xufSk7XG5cbmh0dHBSZXF1ZXN0cy5nZXQoJy9nZXRCZWRzJykudGhlbihyZXNwb25zZSA9PiB7XG4gICAgcmVzcG9uc2UuanNvbigpLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgIGxldCBpID0gMTtcbiAgICAgICAgZGF0YS5mb3JFYWNoKG9iaiA9PiB7XG4gICAgICAgICAgICB3aW5kb3cucGxhbnRNYW5hZ2VyLnJlY3RhbmdsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogb2JqLmJlZF9uYW1lLFxuICAgICAgICAgICAgICAgIHg6IG9iai5iZWRfeCxcbiAgICAgICAgICAgICAgICB5OiBvYmouYmVkX3ksXG4gICAgICAgICAgICAgICAgd2lkdGg6IG9iai5iZWRfd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBvYmouYmVkX2hlaWdodCxcbiAgICAgICAgICAgICAgICBmaWxsOiBvYmouYmVkX2NvbG91cixcbiAgICAgICAgICAgICAgICBzb2lsX2NoYXJhY3RlcmlzdGljczogb2JqLmJlZF9zb2lsX2NoYXJhY3RlcmlzdGljcyxcbiAgICAgICAgICAgICAgICBiZWRfdHlwZTogb2JqLmJlZF90eXBlLFxuICAgICAgICAgICAgICAgIGlzRHJhZ2dpbmc6IGZhbHNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmKGkgPD0gMzEpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS10YWJsZS1uYW1lLSR7aX1dYCkudGV4dENvbnRlbnQgPSBvYmouYmVkX25hbWU7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtdGFibGUtdHlwZS0ke2l9XWApLnRleHRDb250ZW50ID0gb2JqLmJlZF90eXBlO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXRhYmxlLXNvaWwtY2hhcmFjdGVyaXN0aWNzLSR7aX1dYCkudGV4dENvbnRlbnQgPSBvYmouYmVkX3NvaWxfY2hhcmFjdGVyaXN0aWNzO1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHdpbmRvdy5wbGFudE1hbmFnZXIuZHJhd0FsbCgpO1xuICAgIH0pO1xufSk7IiwiZnVuY3Rpb24gc2VuZENyZWF0ZVBsYW50UmVxdWVzdCgpIHtcbiAgICBjb25zdCBjcmVhdGVQbGFudEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtW2RhdGEtY3JlYXRlLXBsYW50XScpO1xuICAgIGNvbnN0IHBsYW50X25hbWUgPSBjcmVhdGVQbGFudEZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbZGF0YS1wbGFudC1uYW1lXScpLnZhbHVlO1xuICAgIGNvbnN0IGRhdGVfcGxhbnRlZCA9IGNyZWF0ZVBsYW50Rm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtkYXRhLXBsYW50LWRhdGUtcGxhbnRlZF0nKS52YWx1ZTtcbiAgICBwb3N0KCcvY3JlYXRlUGxhbnQnLCB7cGxhbnRfbmFtZSwgZGF0ZV9wbGFudGVkfSk7XG59XG5cbmZ1bmN0aW9uIHNlbmRDcmVhdGVCZWRSZXF1ZXN0KCkge1xuICAgIGNvbnN0IGNyZWF0ZUJlZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtW2RhdGEtY3JlYXRlLWJlZF0nKTtcbiAgICBjb25zdCBiZWRfbmFtZSA9IGNyZWF0ZUJlZEZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbZGF0YS1iZWQtbmFtZV0nKS52YWx1ZTtcbiAgICBjb25zdCBiZWRfc29pbF9jaGFyYWN0ZXJpc3RpY3MgPSBjcmVhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdFtkYXRhLWJlZC1zb2lsLWNoYXJhY3RlcmlzdGljc10nKS52YWx1ZTtcbiAgICBjb25zdCBiZWRfdHlwZSA9IGNyZWF0ZUJlZEZvcm0ucXVlcnlTZWxlY3Rvcignc2VsZWN0W2RhdGEtYmVkLXR5cGVdJykudmFsdWU7XG4gICAgY29uc3QgYmVkX3dpZHRoID0gY3JlYXRlQmVkRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtkYXRhLWJlZC13aWR0aF0nKS52YWx1ZTtcbiAgICBjb25zdCBiZWRfaGVpZ2h0ID0gY3JlYXRlQmVkRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtkYXRhLWJlZC1oZWlnaHRdJykudmFsdWU7XG4gICAgY29uc3QgYmVkX2NvbG91ciA9IGNyZWF0ZUJlZEZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbZGF0YS1iZWQtY29sb3VyXScpLnZhbHVlO1xuICAgIGNvbnN0IGJlZF94ID0gMjAwO1xuICAgIGNvbnN0IGJlZF95ID0gMzAwO1xuICAgIHBvc3QoJy9jcmVhdGVCZWQnLCB7YmVkX25hbWUsIGJlZF9zb2lsX2NoYXJhY3RlcmlzdGljcywgYmVkX3R5cGUsIGJlZF93aWR0aCwgYmVkX2hlaWdodCwgYmVkX2NvbG91ciwgYmVkX3gsIGJlZF95fSk7XG59XG5cbmZ1bmN0aW9uIHNlbmRTYXZlQWxsQmVkUG9zaXRpb25zUmVxdWVzdCgpIHtcbiAgICBjb25zdCBwbSA9IHdpbmRvdy5wbGFudE1hbmFnZXI7XG4gICAgZm9yIChsZXQgeiA9IDA7IHogPCBwbS5yZWN0YW5nbGVzLmxlbmd0aDsgeisrKSB7XG4gICAgICAgIHBvc3QoJy91cGRhdGVCZWRQb3NpdGlvbicse2JlZF9uYW1lOiBwbS5yZWN0YW5nbGVzW3pdLm5hbWUsIGJlZF94OiBwbS5yZWN0YW5nbGVzW3pdLngsIGJlZF95OiBwbS5yZWN0YW5nbGVzW3pdLnl9KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHNlbmRTYXZlQmVkUmVxdWVzdCgpIHtcbiAgICBjb25zdCB1cGRhdGVCZWRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVtkYXRhLXVwZGF0ZS1iZWRdJyk7XG4gICAgY29uc3QgbmFtZSA9IHVwZGF0ZUJlZEZvcm0ucXVlcnlTZWxlY3RvcignW2RhdGEtYmVkLW5hbWVdJykudmFsdWU7XG4gICAgY29uc3Qgd2lkdGggPSB1cGRhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJlZC13aWR0aF0nKS52YWx1ZTtcbiAgICBjb25zdCBoZWlnaHQgPSB1cGRhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJlZC1oZWlnaHRdJykudmFsdWU7XG4gICAgY29uc3QgZmlsbCA9IHVwZGF0ZUJlZEZvcm0ucXVlcnlTZWxlY3RvcignW2RhdGEtYmVkLWNvbG91cl0nKS52YWx1ZTtcbiAgICBjb25zdCBzb2lsQ2hhcmFjdGVyaXN0aWNzID0gdXBkYXRlQmVkRm9ybS5xdWVyeVNlbGVjdG9yKCdbZGF0YS1iZWQtc29pbC1jaGFyYWN0ZXJpc3RpY3NdJykudmFsdWU7XG4gICAgY29uc3QgdHlwZSA9IHVwZGF0ZUJlZEZvcm0ucXVlcnlTZWxlY3RvcignW2RhdGEtYmVkLXR5cGVdJykudmFsdWU7XG4gICAgcG9zdCgnL3VwZGF0ZUJlZCcse2JlZF9uYW1lOiBuYW1lLCBiZWRfc29pbF9jaGFyYWN0ZXJpc3RpY3M6IHNvaWxDaGFyYWN0ZXJpc3RpY3MsIGJlZF90eXBlOiB0eXBlLCBiZWRfd2lkdGg6IHdpZHRoLCBiZWRfaGVpZ2h0OiBoZWlnaHQsIGJlZF9jb2xvdXI6IGZpbGx9KTtcbn1cblxuZnVuY3Rpb24gc2VuZERlbGV0ZUJlZFJlcXVlc3QoKSB7XG4gICAgY29uc3QgdXBkYXRlQmVkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm1bZGF0YS11cGRhdGUtYmVkXScpO1xuICAgIGNvbnN0IG5hbWUgPSB1cGRhdGVCZWRGb3JtLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJlZC1uYW1lXScpLnZhbHVlO1xuICAgIHdpbmRvdy5wbGFudE1hbmFnZXIucmVjdGFuZ2xlcyA9IHdpbmRvdy5wbGFudE1hbmFnZXIucmVjdGFuZ2xlcy5maWx0ZXIob2JqID0+IHtcbiAgICAgICAgcmV0dXJuIG9iai5uYW1lICE9PSBuYW1lO1xuICAgIH0pO1xuICAgIHBvc3QoJy9kZWxldGVCZWQnLHtiZWRfbmFtZTogbmFtZX0pO1xufVxuXG5mdW5jdGlvbiBwb3N0KHBhdGgsIGRhdGEpIHtcbiAgICByZXR1cm4gd2luZG93LmZldGNoKHBhdGgsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldChwYXRoKSB7XG4gICAgcmV0dXJuIHdpbmRvdy5mZXRjaChwYXRoLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZSwgbm8tc3RvcmUsIG11c3QtcmV2YWxpZGF0ZScsXG4gICAgICAgICAgICAnUHJhZ21hJzogJ25vLWNhY2hlJyxcbiAgICAgICAgICAgICdFeHBpcmVzJzogMFxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIHNlbmRDcmVhdGVQbGFudFJlcXVlc3QsXG4gICAgc2VuZENyZWF0ZUJlZFJlcXVlc3QsXG4gICAgc2VuZFNhdmVBbGxCZWRQb3NpdGlvbnNSZXF1ZXN0LFxuICAgIHNlbmRTYXZlQmVkUmVxdWVzdCxcbiAgICBzZW5kRGVsZXRlQmVkUmVxdWVzdCxcbiAgICBnZXQsXG4gICAgcG9zdFxufTsiXX0="}