{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/draw-on-canvas.js","src/interact-with-canvas.js","src/mouse-event-handlers.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"interact-with-canvas.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","function clearCanvas() {\n    const canvas = document.querySelector('canvas');\n    const canvasContext = canvas.getContext('2d');\n    canvasContext.clearRect(0, 0, canvas.width, canvas.height);\n}\n\nfunction drawRectangle(x, y, w, h) {\n    const canvasContext = document.querySelector('canvas').getContext('2d');\n    canvasContext.beginPath();\n    canvasContext.rect(x, y, w, h);\n    canvasContext.closePath();\n    canvasContext.fill();\n}\n\nfunction drawAll() {\n    const pm = window.plantManager;\n    const canvas = document.querySelector('canvas');\n    const canvasContext = canvas.getContext('2d');\n    clearCanvas();\n    canvasContext.fillStyle = \"#af865d3d\";\n    drawRectangle(0, 0, canvas.width, canvas.height);\n    for (let i = 0; i < pm.rectangles.length; i++) {\n        const r = pm.rectangles[i];\n        canvasContext.fillStyle = r.fill;\n        drawRectangle(r.x, r.y, r.width, r.height);\n    }\n}\n\nmodule.exports = {\n    clearCanvas,\n    drawRectangle,\n    drawAll\n};","const mouseEventHandlers = require('./mouse-event-handlers');\nconst drawOnCanvas = require('./draw-on-canvas');\n\nconst canvas = document.querySelector('canvas');\nconst canvasContext = canvas.getContext('2d');\n\nwindow.plantManager = {\n    canvasOffsetX: canvas.getBoundingClientRect().left,\n    canvasOffsetY: canvas.getBoundingClientRect().top,\n    rectangles: []\n};\nconst pm = window.plantManager;\n\ncanvasContext.fillStyle = \"#af865d3d\";\ncanvasContext.fillRect(0,0, canvas.width, canvas.height);\n\nmouseEventHandlers.setupMouseEventVariables();\ncanvas.onmousedown = mouseEventHandlers.mouseDownHandler;\ncanvas.onmouseup = mouseEventHandlers.mouseUpHandler;\ncanvas.onmousemove = mouseEventHandlers.mouseMoveHandler;\n\ndrawOnCanvas.drawAll();\npm.drawAll = drawOnCanvas.drawAll;","const drawOnCanvas = require('./draw-on-canvas');\n\nfunction mouseUpHandler(e) {\n    const pm = window.plantManager;\n    const mouseEventVars = pm.mouseEventVariables;\n    e.preventDefault();\n    e.stopPropagation();\n\n    // clear all the dragging flags\n    mouseEventVars.dragok = false;\n\n    for (let z = 0; z < pm.rectangles.length; z++) {\n        pm.rectangles[z].isDragging = false;\n    }\n\n    // for (let i = 0; i < pm.rectangles.length; i++) {\n    //     const r = pm.rectangles[i];\n    //     const bed_name = r.name;\n    //     const bed_x = r.x;\n    //     const bed_y = r.y;\n    //     console.log({bed_name, bed_x, bed_y});\n    //     post('/updateRecPosition', {bed_name, bed_x, bed_y});\n    // }\n}\n\nfunction mouseDownHandler(e) {\n    const pm = window.plantManager;\n    const mouseEventVars = pm.mouseEventVariables;\n    e.preventDefault();\n    e.stopPropagation();\n\n    // get the current mouse position\n    const mx = parseInt(e.clientX - pm.canvasOffsetX);\n    const my = parseInt(e.clientY - pm.canvasOffsetY);\n\n    // test each rect to see if mouse is inside\n    mouseEventVars.dragok = false;\n    for (let i = 0; i < pm.rectangles.length; i++) {\n        const r = pm.rectangles[i];\n        if (mx > r.x && mx < (r.x + r.width) && my > r.y && my < (r.y + r.height)) {\n            // if yes, set that rects isDragging=true\n            console.log('rec just started dragging  ', r);\n            console.log((mx > r.x) +\"  \"+ (mx < r.x + r.width) +\"  \"+ (my > r.y) +\"  \"+ (my < r.y + r.height));\n            console.log(\"rec \" + r.name + \" - mouse x position \" + mx + \" is greater than rectangle x \" + r.x);\n            console.log(\"rec \" + r.name + \" - mouse x position \" + mx + \" is less than rectangle x \" + r.x + \" plus rectangle width \" + r.width);\n            console.log(\"rec \" + r.name + \" - mouse y position \" + my + \" is greater than rectangle y \" + r.y);\n            console.log(\"rec \" + r.name + \" - mouse y position \" + my + \" is less than rectangle y \" + r.y + \" plus rectangle height \" + r.height);\n            mouseEventVars.dragok = true;\n            r.isDragging = true;\n        }\n    }\n    // save the current mouse position\n    mouseEventVars.startX = mx;\n    mouseEventVars.startY = my;\n}\n\nfunction mouseMoveHandler(e) {\n    const pm = window.plantManager;\n    const mouseEventVars = pm.mouseEventVariables;\n    // if we're dragging anything...\n    if (mouseEventVars.dragok) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        // get the current mouse position\n        const mx = parseInt(e.clientX - pm.canvasOffsetX);\n        const my = parseInt(e.clientY - pm.canvasOffsetY);\n\n        // calculate the distance the mouse has moved\n        // since the last mousemove\n        const dx = mx - mouseEventVars.startX;\n        const dy = my - mouseEventVars.startY;\n\n        // move each rect that isDragging\n        // by the distance the mouse has moved\n        // since the last mousemove\n        for (let i = 0; i < pm.rectangles.length; i++) {\n            const r = pm.rectangles[i];\n            if (r.isDragging) {\n                r.x += dx;\n                r.y += dy;\n            }\n        }\n\n        // redraw the scene with the new rect positions\n        drawOnCanvas.drawAll();\n\n        // reset the starting mouse position for the next mousemove\n        mouseEventVars.startX = mx;\n        mouseEventVars.startY = my;\n    }\n}\n\nfunction setupMouseEventVariables() {\n    const pm = window.plantManager;\n    const mouseEventVars = pm.mouseEventVariables = {};\n    mouseEventVars.dragok = false;\n    mouseEventVars.startX = undefined;\n    mouseEventVars.startY = undefined;\n}\n\nfunction post(path, data) {\n    return window.fetch(path, {\n        method: 'POST',\n        headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n    });\n}\n\nmodule.exports = {\n    mouseUpHandler,\n    mouseDownHandler,\n    mouseMoveHandler,\n    setupMouseEventVariables\n};"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvZHJhdy1vbi1jYW52YXMuanMiLCJzcmMvaW50ZXJhY3Qtd2l0aC1jYW52YXMuanMiLCJzcmMvbW91c2UtZXZlbnQtaGFuZGxlcnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiZnVuY3Rpb24gY2xlYXJDYW52YXMoKSB7XG4gICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7XG4gICAgY29uc3QgY2FudmFzQ29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGNhbnZhc0NvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG59XG5cbmZ1bmN0aW9uIGRyYXdSZWN0YW5nbGUoeCwgeSwgdywgaCkge1xuICAgIGNvbnN0IGNhbnZhc0NvbnRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdjYW52YXMnKS5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGNhbnZhc0NvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgY2FudmFzQ29udGV4dC5yZWN0KHgsIHksIHcsIGgpO1xuICAgIGNhbnZhc0NvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgY2FudmFzQ29udGV4dC5maWxsKCk7XG59XG5cbmZ1bmN0aW9uIGRyYXdBbGwoKSB7XG4gICAgY29uc3QgcG0gPSB3aW5kb3cucGxhbnRNYW5hZ2VyO1xuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2NhbnZhcycpO1xuICAgIGNvbnN0IGNhbnZhc0NvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBjbGVhckNhbnZhcygpO1xuICAgIGNhbnZhc0NvbnRleHQuZmlsbFN0eWxlID0gXCIjYWY4NjVkM2RcIjtcbiAgICBkcmF3UmVjdGFuZ2xlKDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwbS5yZWN0YW5nbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHIgPSBwbS5yZWN0YW5nbGVzW2ldO1xuICAgICAgICBjYW52YXNDb250ZXh0LmZpbGxTdHlsZSA9IHIuZmlsbDtcbiAgICAgICAgZHJhd1JlY3RhbmdsZShyLngsIHIueSwgci53aWR0aCwgci5oZWlnaHQpO1xuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgY2xlYXJDYW52YXMsXG4gICAgZHJhd1JlY3RhbmdsZSxcbiAgICBkcmF3QWxsXG59OyIsImNvbnN0IG1vdXNlRXZlbnRIYW5kbGVycyA9IHJlcXVpcmUoJy4vbW91c2UtZXZlbnQtaGFuZGxlcnMnKTtcbmNvbnN0IGRyYXdPbkNhbnZhcyA9IHJlcXVpcmUoJy4vZHJhdy1vbi1jYW52YXMnKTtcblxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7XG5jb25zdCBjYW52YXNDb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbndpbmRvdy5wbGFudE1hbmFnZXIgPSB7XG4gICAgY2FudmFzT2Zmc2V0WDogY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQsXG4gICAgY2FudmFzT2Zmc2V0WTogY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCxcbiAgICByZWN0YW5nbGVzOiBbXVxufTtcbmNvbnN0IHBtID0gd2luZG93LnBsYW50TWFuYWdlcjtcblxuY2FudmFzQ29udGV4dC5maWxsU3R5bGUgPSBcIiNhZjg2NWQzZFwiO1xuY2FudmFzQ29udGV4dC5maWxsUmVjdCgwLDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cbm1vdXNlRXZlbnRIYW5kbGVycy5zZXR1cE1vdXNlRXZlbnRWYXJpYWJsZXMoKTtcbmNhbnZhcy5vbm1vdXNlZG93biA9IG1vdXNlRXZlbnRIYW5kbGVycy5tb3VzZURvd25IYW5kbGVyO1xuY2FudmFzLm9ubW91c2V1cCA9IG1vdXNlRXZlbnRIYW5kbGVycy5tb3VzZVVwSGFuZGxlcjtcbmNhbnZhcy5vbm1vdXNlbW92ZSA9IG1vdXNlRXZlbnRIYW5kbGVycy5tb3VzZU1vdmVIYW5kbGVyO1xuXG5kcmF3T25DYW52YXMuZHJhd0FsbCgpO1xucG0uZHJhd0FsbCA9IGRyYXdPbkNhbnZhcy5kcmF3QWxsOyIsImNvbnN0IGRyYXdPbkNhbnZhcyA9IHJlcXVpcmUoJy4vZHJhdy1vbi1jYW52YXMnKTtcblxuZnVuY3Rpb24gbW91c2VVcEhhbmRsZXIoZSkge1xuICAgIGNvbnN0IHBtID0gd2luZG93LnBsYW50TWFuYWdlcjtcbiAgICBjb25zdCBtb3VzZUV2ZW50VmFycyA9IHBtLm1vdXNlRXZlbnRWYXJpYWJsZXM7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAvLyBjbGVhciBhbGwgdGhlIGRyYWdnaW5nIGZsYWdzXG4gICAgbW91c2VFdmVudFZhcnMuZHJhZ29rID0gZmFsc2U7XG5cbiAgICBmb3IgKGxldCB6ID0gMDsgeiA8IHBtLnJlY3RhbmdsZXMubGVuZ3RoOyB6KyspIHtcbiAgICAgICAgcG0ucmVjdGFuZ2xlc1t6XS5pc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCBwbS5yZWN0YW5nbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gICAgIGNvbnN0IHIgPSBwbS5yZWN0YW5nbGVzW2ldO1xuICAgIC8vICAgICBjb25zdCBiZWRfbmFtZSA9IHIubmFtZTtcbiAgICAvLyAgICAgY29uc3QgYmVkX3ggPSByLng7XG4gICAgLy8gICAgIGNvbnN0IGJlZF95ID0gci55O1xuICAgIC8vICAgICBjb25zb2xlLmxvZyh7YmVkX25hbWUsIGJlZF94LCBiZWRfeX0pO1xuICAgIC8vICAgICBwb3N0KCcvdXBkYXRlUmVjUG9zaXRpb24nLCB7YmVkX25hbWUsIGJlZF94LCBiZWRfeX0pO1xuICAgIC8vIH1cbn1cblxuZnVuY3Rpb24gbW91c2VEb3duSGFuZGxlcihlKSB7XG4gICAgY29uc3QgcG0gPSB3aW5kb3cucGxhbnRNYW5hZ2VyO1xuICAgIGNvbnN0IG1vdXNlRXZlbnRWYXJzID0gcG0ubW91c2VFdmVudFZhcmlhYmxlcztcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgIC8vIGdldCB0aGUgY3VycmVudCBtb3VzZSBwb3NpdGlvblxuICAgIGNvbnN0IG14ID0gcGFyc2VJbnQoZS5jbGllbnRYIC0gcG0uY2FudmFzT2Zmc2V0WCk7XG4gICAgY29uc3QgbXkgPSBwYXJzZUludChlLmNsaWVudFkgLSBwbS5jYW52YXNPZmZzZXRZKTtcblxuICAgIC8vIHRlc3QgZWFjaCByZWN0IHRvIHNlZSBpZiBtb3VzZSBpcyBpbnNpZGVcbiAgICBtb3VzZUV2ZW50VmFycy5kcmFnb2sgPSBmYWxzZTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBtLnJlY3RhbmdsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgciA9IHBtLnJlY3RhbmdsZXNbaV07XG4gICAgICAgIGlmIChteCA+IHIueCAmJiBteCA8IChyLnggKyByLndpZHRoKSAmJiBteSA+IHIueSAmJiBteSA8IChyLnkgKyByLmhlaWdodCkpIHtcbiAgICAgICAgICAgIC8vIGlmIHllcywgc2V0IHRoYXQgcmVjdHMgaXNEcmFnZ2luZz10cnVlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVjIGp1c3Qgc3RhcnRlZCBkcmFnZ2luZyAgJywgcik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygobXggPiByLngpICtcIiAgXCIrIChteCA8IHIueCArIHIud2lkdGgpICtcIiAgXCIrIChteSA+IHIueSkgK1wiICBcIisgKG15IDwgci55ICsgci5oZWlnaHQpKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVjIFwiICsgci5uYW1lICsgXCIgLSBtb3VzZSB4IHBvc2l0aW9uIFwiICsgbXggKyBcIiBpcyBncmVhdGVyIHRoYW4gcmVjdGFuZ2xlIHggXCIgKyByLngpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZWMgXCIgKyByLm5hbWUgKyBcIiAtIG1vdXNlIHggcG9zaXRpb24gXCIgKyBteCArIFwiIGlzIGxlc3MgdGhhbiByZWN0YW5nbGUgeCBcIiArIHIueCArIFwiIHBsdXMgcmVjdGFuZ2xlIHdpZHRoIFwiICsgci53aWR0aCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlYyBcIiArIHIubmFtZSArIFwiIC0gbW91c2UgeSBwb3NpdGlvbiBcIiArIG15ICsgXCIgaXMgZ3JlYXRlciB0aGFuIHJlY3RhbmdsZSB5IFwiICsgci55KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVjIFwiICsgci5uYW1lICsgXCIgLSBtb3VzZSB5IHBvc2l0aW9uIFwiICsgbXkgKyBcIiBpcyBsZXNzIHRoYW4gcmVjdGFuZ2xlIHkgXCIgKyByLnkgKyBcIiBwbHVzIHJlY3RhbmdsZSBoZWlnaHQgXCIgKyByLmhlaWdodCk7XG4gICAgICAgICAgICBtb3VzZUV2ZW50VmFycy5kcmFnb2sgPSB0cnVlO1xuICAgICAgICAgICAgci5pc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBzYXZlIHRoZSBjdXJyZW50IG1vdXNlIHBvc2l0aW9uXG4gICAgbW91c2VFdmVudFZhcnMuc3RhcnRYID0gbXg7XG4gICAgbW91c2VFdmVudFZhcnMuc3RhcnRZID0gbXk7XG59XG5cbmZ1bmN0aW9uIG1vdXNlTW92ZUhhbmRsZXIoZSkge1xuICAgIGNvbnN0IHBtID0gd2luZG93LnBsYW50TWFuYWdlcjtcbiAgICBjb25zdCBtb3VzZUV2ZW50VmFycyA9IHBtLm1vdXNlRXZlbnRWYXJpYWJsZXM7XG4gICAgLy8gaWYgd2UncmUgZHJhZ2dpbmcgYW55dGhpbmcuLi5cbiAgICBpZiAobW91c2VFdmVudFZhcnMuZHJhZ29rKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAvLyBnZXQgdGhlIGN1cnJlbnQgbW91c2UgcG9zaXRpb25cbiAgICAgICAgY29uc3QgbXggPSBwYXJzZUludChlLmNsaWVudFggLSBwbS5jYW52YXNPZmZzZXRYKTtcbiAgICAgICAgY29uc3QgbXkgPSBwYXJzZUludChlLmNsaWVudFkgLSBwbS5jYW52YXNPZmZzZXRZKTtcblxuICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIGRpc3RhbmNlIHRoZSBtb3VzZSBoYXMgbW92ZWRcbiAgICAgICAgLy8gc2luY2UgdGhlIGxhc3QgbW91c2Vtb3ZlXG4gICAgICAgIGNvbnN0IGR4ID0gbXggLSBtb3VzZUV2ZW50VmFycy5zdGFydFg7XG4gICAgICAgIGNvbnN0IGR5ID0gbXkgLSBtb3VzZUV2ZW50VmFycy5zdGFydFk7XG5cbiAgICAgICAgLy8gbW92ZSBlYWNoIHJlY3QgdGhhdCBpc0RyYWdnaW5nXG4gICAgICAgIC8vIGJ5IHRoZSBkaXN0YW5jZSB0aGUgbW91c2UgaGFzIG1vdmVkXG4gICAgICAgIC8vIHNpbmNlIHRoZSBsYXN0IG1vdXNlbW92ZVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBtLnJlY3RhbmdsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBwbS5yZWN0YW5nbGVzW2ldO1xuICAgICAgICAgICAgaWYgKHIuaXNEcmFnZ2luZykge1xuICAgICAgICAgICAgICAgIHIueCArPSBkeDtcbiAgICAgICAgICAgICAgICByLnkgKz0gZHk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZWRyYXcgdGhlIHNjZW5lIHdpdGggdGhlIG5ldyByZWN0IHBvc2l0aW9uc1xuICAgICAgICBkcmF3T25DYW52YXMuZHJhd0FsbCgpO1xuXG4gICAgICAgIC8vIHJlc2V0IHRoZSBzdGFydGluZyBtb3VzZSBwb3NpdGlvbiBmb3IgdGhlIG5leHQgbW91c2Vtb3ZlXG4gICAgICAgIG1vdXNlRXZlbnRWYXJzLnN0YXJ0WCA9IG14O1xuICAgICAgICBtb3VzZUV2ZW50VmFycy5zdGFydFkgPSBteTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHNldHVwTW91c2VFdmVudFZhcmlhYmxlcygpIHtcbiAgICBjb25zdCBwbSA9IHdpbmRvdy5wbGFudE1hbmFnZXI7XG4gICAgY29uc3QgbW91c2VFdmVudFZhcnMgPSBwbS5tb3VzZUV2ZW50VmFyaWFibGVzID0ge307XG4gICAgbW91c2VFdmVudFZhcnMuZHJhZ29rID0gZmFsc2U7XG4gICAgbW91c2VFdmVudFZhcnMuc3RhcnRYID0gdW5kZWZpbmVkO1xuICAgIG1vdXNlRXZlbnRWYXJzLnN0YXJ0WSA9IHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gcG9zdChwYXRoLCBkYXRhKSB7XG4gICAgcmV0dXJuIHdpbmRvdy5mZXRjaChwYXRoLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBtb3VzZVVwSGFuZGxlcixcbiAgICBtb3VzZURvd25IYW5kbGVyLFxuICAgIG1vdXNlTW92ZUhhbmRsZXIsXG4gICAgc2V0dXBNb3VzZUV2ZW50VmFyaWFibGVzXG59OyJdfQ=="}